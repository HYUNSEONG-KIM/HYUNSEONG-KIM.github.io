---
layout: post
title: 정렬
parent: GSL 과학계산 라이브러리
grand_parent: Books
nav_order: 42
use_math: true
---

GSL
{: .label }
C
{: .label .label-grey}
Kor
{: label .label-blue}
Writing
{: .label .label-red}

1. TOC
{:toc}




이 단원에서는 선형 최소 제곱법을 이용해 실험 값을 여러 함수들의 조합으로 표현하는 기능을 서술합니다. 각 계산은 알려진 오차를 포함하거나 포함하지 않을 수도 있습니다. 가중치가 있는 값들에 대해, 각 함수들은 최적의 계수를 계산하고 그들에 대한 버금 공분산 행렬(associated covariance matrix)를 찾습니다. 가중치가 없는 값들은 각 지점의 분포를 이용해 공분산 행렬을 찾고, 분산-공분산 행렬(variance-covariance matrix)을 제공합니다.

이 단원의 함수들은 여러 형태로 나누어져 있습니다. 단순한 1개, 2개의 계수를 받는 분석 함수와 여러 계수를 사용 가능한 분석 함수로 나누어져 있습니다.

## 개요

최소 제곱법은 $\chi^2$을 최소화 시켜 찾을 수 있습니다. 이 값은 모델 $Y(c,x)$에 대해, $n$개의 실험 값들의 가중 잔차 제곱합(weighted sum of squared residual)을 의미합니다. 

$$\chi^2 = \sum_i w_i (y_i - Y(c,x_i))^2$$

모델의 $p$ 계수는 $c=\{ c_0, c_1, \dots \}$ 입니다. 가중 계수 $w_i$는 $w_i = 1/\sigma_i^2$로 주어집니다. $\sigma_i$는 지점 $y_i$의 실험 오차입니다. 이 오차들은 정규 분포(가우스 분포)를 따르고 비상관(uncorrelated) 관계에 있다고 가정합니다. 가중치가 없는 값들에 대해, $\chi^2$은 가중치 계수가 없이 계산됩니다.

피팅 함수들은 가장 잘 맞는 계수 $c$와 $p\times p$ 차원의 공분산 행렬을 반환합니다. 공분산 행렬은 값들에 있는 오차($\sigma_i$)로 인해 생기는 계수 $c$의 통계적 오차를 측정합니다. 이 행렬은 다음과 같이 정의됩니다.

$$C_{ab} = \braket{\delta{c_a} \delta{c_b}}$$


$\braket{}$은 해당 값 아래, 가우스 오차 분포 함수의 평균값을 나타냅니다.


공분산 행렬은 각 지점의 오차 $\sigma_i$의 오차 전파로 계산할 수 있습니다. 값 $\sigma_{y_i}$의 변화로 생기는 피팅 계수의 변화량 $\delta_{c_a}$은 다음과 같이 주어집니다.

$$\sigma{c_a} = \sum_i \frac{\partial c_a}{\partial y_i} \delta y_i$$

비상관 값들은, 다음을 만족합니다.

$$\braket{\delta y_i \delta y_j} = \sigma_i^2 \delta_{ij}$$

이때, 해당하는 공분산 행렬은 다음과 같이 계산할 수 있습니다.

$$C_{ab} = \sum_i \frac{1}{w_i} \frac{\partial c_a}{\partial y_i} \frac{\partial c_b}{\partial y_i}$$

가중치가 없는 값들은 공분산 행렬을  계산할때, 급수에서 가중 계수 $w_i$가 단일한 값 $w = \frac{1}{\sigma^2}$로 대체됩니다. $\sigma^2$는 최적 추정 계수에 대한, 잔차 분포로 $\sigma^2 = \sum (y_i - Y(c,x_i))^2/(n-p)$와 같이 계산됩니다. 이를 분산-공분산 행렬이라 합니다.

최적 추정 계수들에 대한 표준 편차는 해당하는 공분산 함수의 대각 성분의 제곱근으로 계산됩니다. $\sigma_{c_a} = \sqrt{C_{aa}}$. 계수 $c_a$와 $c_b$의 상관 계수는 $\rho_{ab} = C_{ab}/\sqrt{C_{aa}C_{bb}}$로 주어집니다.

## 선형 회귀(Linear regression)

이 단원의 함수들은 계수가 1, 2개인 간단한 선형 회귀 모델을 계산합니다. 이 단원의 함수들은 헤더 파일 `gsl_fit.h`에 정의되어 있습니다.

### 상수항을 가지는 선형 회귀 모델

이 단원의 함수들은 일직선 형태의 모델 $Y(c,x) = c_o +c_1 x$에 대한 선형 회귀 분석을 계산합니다.


>int gsl_fit_linear(const double *x, const size_t xstride, const double *y, const size_t ystride, size_t n, double *c0, double *c1, double *cov00, double *cov01, double *cov11, double *sumsq)


>int gsl_fit_linear(const double *x, const size_t xstride, const double *y, const size_t ystride, size_t n, double *c0, double *c1, double *cov00, double *cov01, double *cov11, double *sumsq)

>int gsl_fit_linear_est(double x, double c0, double c1, double cov00, double cov01, double cov11, double *y, double *y_err)

### 상수항이 없는 선형 회귀 모델


>int gsl_fit_mul(const double *x, const size_t xstride, const double *y, const size_t ystride, size_t n, double *c1, double *cov11, double *sumsq)

>int gsl_fit_wmul(const double *x, const size_t xstride, const double *w, const size_t wstride, const double *y, const size_t ystride, size_t n, double *c1, double *cov11, double *sumsq)


>int gsl_fit_mul_est(double x, double c1, double cov11, double *y, double *y_err)


### 여러 계수를 가지는 선형 모델

>type gsl_multifit_linear_workspace


>gsl_multifit_linear_workspace *gsl_multifit_linear_alloc(const size_t n, const size_t p)


>void gsl_multifit_linear_free(gsl_multifit_linear_workspace *work)


>int gsl_multifit_linear_bsvd(const gsl_matrix *X, gsl_multifit_linear_workspace *work)


>int gsl_multifit_linear(const gsl_matrix *X, const gsl_vector *y, gsl_vector *c, gsl_matrix *cov, double *chisq, gsl_multifit_linear_workspace *work)


>int gsl_multifit_linear(const gsl_matrix *X, const gsl_vector *y, gsl_vector *c, gsl_matrix *cov, double *chisq, gsl_multifit_linear_workspace *work)


>int gsl_multifit_wlinear(const gsl_matrix *X, const gsl_vector *w, const gsl_vector *y, gsl_vector *c, gsl_matrix *cov, double *chisq, gsl_multifit_linear_workspace *work)


>int gsl_multifit_wlinear_tsvd(const gsl_matrix *X, const gsl_vector *w, const gsl_vector *y, const double tol, gsl_vector *c, gsl_matrix *cov, double *chisq, size_t *rank, gsl_multifit_linear_workspace *work)


>int gsl_multifit_linear_est(const gsl_vector *x, const gsl_vector *c, const gsl_matrix *cov, double *y, double *y_err)

>int gsl_multifit_linear_residuals(const gsl_matrix *X, const gsl_vector *y, const gsl_vector *c, gsl_vector *r)

>size_t gsl_multifit_linear_rank(const double tol, const gsl_multifit_linear_workspace *work)


## 정규화된 회귀 분석(Regularized regression)


## 로버스트 회귀 분석(Robust regression)


## 대규모 선형계(Large dense liear systems)

###
###
###
###

## 

## 예제

## 참고문헌과 추가자료

최소 제곱법과 관련된 수식과 기법들은 Particle Data Group에서 출판한 The Review of Particle Physics의 "Statistics" 단원을 참고할 수 있습니다.

* Review of Particle Properties, R.M. Barnett et al., Physical Review D54, 1 (1996) http://pdg.lbl.gov

The Review of Particle Physics은 위의 링크에서 볼 수 있습니다.

이 단원에서 구현된 기능들을 검사하는 데는 NIST Statistical Reference Datasets을 사용했습니다. 해당 값과 문서들은 NIST 사이트를 참고할 수 있습니다.

http://www.nist.gov/itl/div898/strd/index.html

Tikhonov regularization에 대한 자세한 정보는 다음을 참고할 수 있습니다.

* Hansen, P. C. (1998), Rank-Deficient and Discrete Ill-Posed Problems: Numerical Aspects of Linear Inversion. SIAM Monogr. on Mathematical Modeling and Computation, Society for Industrial and Applied Mathematics

* M. Rezghi and S. M. Hosseini (2009), A new variant of L-curve for Tikhonov regularization, Journal of Computational and Applied Mathematics, Volume 231, Issue 2, pages 914-924.

GSL의 로버스트 선형 회귀 구현체는 다음 출판물에 기반해 있습니다.

* DuMouchel, W. and F. O’Brien (1989), “Integrating a robust option into a multiple regression computing environment,” Computer Science and Statistics: Proceedings of the 21st Symposium on the Interface, American Statistical Association

* Street, J.O., R.J. Carroll, and D. Ruppert (1988), “A note on computing robust regression estimates via iteratively reweighted least squares,” The American Statistician, v. 42, pp. 152-154.


정규 방정식들과 TSQR을 이용한 대규모 선형 최소 제곱계의 풀이는 다음을 참고할 수 있습니다.

* *Trefethen, L. N. and Bau, D. (1997), “Numerical Linear Algebra”, SIAM.

* Demmel, J., Grigori, L., Hoemmen, M. F., and Langou, J. “Communication-optimal parallel and sequential QR and LU factorizations”, UCB Technical Report No. UCB/EECS-2008-89, 2008.


